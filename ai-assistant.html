<!-- AI Assistant Button (Fixed Position) -->
<button id="ai-assistant-btn" class="fixed right-4 bottom-4 md:right-6 md:bottom-6 z-50 group" aria-label="Open AI Assistant">
  <div class="relative">
    <div class="absolute inset-0 bg-primary/30 rounded-full blur-md animate-pulse-glow"></div>
    <div class="relative w-12 h-12 md:w-14 md:h-14 lg:w-16 lg:h-16 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center shadow-xl hover:shadow-2xl hover:shadow-primary/40 transition-all duration-300 hover:scale-110 active:scale-95">
      <svg class="w-5 h-5 md:w-6 md:h-6 lg:w-7 lg:h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
      </svg>
    </div>
    <span class="absolute -top-1 -right-1 w-4 h-4 md:w-5 md:h-5 lg:w-6 lg:h-6 bg-accent rounded-full flex items-center justify-center text-[10px] md:text-xs font-bold text-white animate-bounce">
      AI
    </span>
  </div>
</button>

<!-- AI Assistant Modal -->
<div id="ai-assistant-modal" class="fixed inset-0 z-[9999] hidden items-center justify-center p-0 sm:p-2 md:p-4 bg-black/60 backdrop-blur-sm transition-all duration-300">
  <div class="relative w-full h-full sm:h-auto sm:max-h-[90vh] sm:max-w-4xl bg-dark/95 border border-primary/30 rounded-none sm:rounded-2xl overflow-hidden shadow-2xl shadow-primary/20 flex flex-col transition-all duration-300 sm:scale-100">
    
    <!-- Header with Swipe Indicator -->
    <div class="bg-gradient-to-r from-dark via-dark/95 to-dark border-b border-light/10 p-3 sm:p-4 md:p-6 flex-shrink-0 relative">
      <!-- Swipe Indicator for Mobile -->
      <div class="sm:hidden absolute top-1 left-1/2 transform -translate-x-1/2 w-10 h-1 bg-light/20 rounded-full"></div>
      
      <div class="flex items-center justify-between mt-2 sm:mt-0">
        <div class="flex items-center space-x-2 sm:space-x-3">
          <div class="w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center">
            <svg class="w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
            </svg>
          </div>
          <div>
            <h3 class="text-base sm:text-lg md:text-xl font-bold text-gradient">AI Portfolio Assistant</h3>
            <p class="text-xs text-light/60 hidden sm:block">Powered by Google Gemini AI</p>
          </div>
        </div>
        <button id="close-ai-modal" class="w-10 h-10 sm:w-8 sm:h-8 md:w-10 md:h-10 rounded-full bg-dark/50 hover:bg-dark/80 border border-light/10 flex items-center justify-center hover:border-primary/50 transition-all duration-300 active:scale-95" aria-label="Close Assistant">
          <svg class="w-5 h-5 sm:w-4 sm:h-4 md:w-5 md:h-5 text-light/70 hover:text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    </div>
    
    <!-- Chat Container -->
    <div id="ai-chat-container" class="flex-1 overflow-y-auto p-3 sm:p-4 space-y-3 sm:space-y-4 min-h-0 safe-area-bottom">
      <!-- Initial Welcome Message -->
      <div class="chat-message ai-message">
        <div class="message-bubble">
          <div class="flex items-center space-x-2 mb-1 sm:mb-2">
            <div class="w-5 h-5 sm:w-6 sm:h-6 rounded-full bg-primary/20 flex items-center justify-center">
              <svg class="w-2.5 h-2.5 sm:w-3 sm:h-3 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
              </svg>
            </div>
            <span class="text-xs font-semibold text-primary">Ali Ahtisham</span>
          </div>
          <p class="text-light/90 text-sm sm:text-base mb-1">Hello! I'm <span class="text-primary font-semibold">Ali Ahtisham</span>. Ask me anything about my work, projects, or experience! üöÄ</p>
          <div class="mt-2 flex flex-wrap gap-1.5 sm:gap-2">
            <span class="quick-query-btn px-3 py-1.5 sm:px-3 sm:py-1 bg-primary/10 hover:bg-primary/20 text-primary rounded-full text-xs cursor-pointer transition-all duration-300 active:scale-95">Introduce yourself</span>
            <span class="quick-query-btn px-3 py-1.5 sm:px-3 sm:py-1 bg-primary/10 hover:bg-primary/20 text-primary rounded-full text-xs cursor-pointer transition-all duration-300 active:scale-95">Your skills</span>
            <span class="quick-query-btn px-3 py-1.5 sm:px-3 sm:py-1 bg-primary/10 hover:bg-primary/20 text-primary rounded-full text-xs cursor-pointer transition-all duration-300 active:scale-95">Show projects</span>
            <span class="quick-query-btn px-3 py-1.5 sm:px-3 sm:py-1 bg-primary/10 hover:bg-primary/20 text-primary rounded-full text-xs cursor-pointer transition-all duration-300 active:scale-95">Contact info</span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Input Area -->
    <div class="border-t border-light/10 bg-dark p-3 sm:p-4 flex-shrink-0 safe-area-bottom">
      <!-- Quick Action Buttons -->
      <div class="flex overflow-x-auto pb-2 sm:pb-3 mb-2 sm:mb-3 space-x-1.5 sm:space-x-2 scrollbar-hide">
        <button class="quick-action-btn flex-shrink-0 px-3 py-2 sm:px-3 sm:py-2 bg-dark/80 hover:bg-primary/10 border border-light/10 hover:border-primary/30 rounded-lg text-xs sm:text-sm transition-all duration-300 flex items-center whitespace-nowrap active:scale-95">
          <svg class="w-4 h-4 sm:w-4 sm:h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          Projects
        </button>
        <button class="quick-action-btn flex-shrink-0 px-3 py-2 sm:px-3 sm:py-2 bg-dark/80 hover:bg-primary/10 border border-light/10 hover:border-primary/30 rounded-lg text-xs sm:text-sm transition-all duration-300 flex items-center whitespace-nowrap active:scale-95">
          <svg class="w-4 h-4 sm:w-4 sm:h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          Skills
        </button>
        <button class="quick-action-btn flex-shrink-0 px-3 py-2 sm:px-3 sm:py-2 bg-dark/80 hover:bg-primary/10 border border-light/10 hover:border-primary/30 rounded-lg text-xs sm:text-sm transition-all duration-300 flex items-center whitespace-nowrap active:scale-95">
          <svg class="w-4 h-4 sm:w-4 sm:h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
          </svg>
          Contact
        </button>
        <button class="quick-action-btn flex-shrink-0 px-3 py-2 sm:px-3 sm:py-2 bg-dark/80 hover:bg-primary/10 border border-light/10 hover:border-primary/30 rounded-lg text-xs sm:text-sm transition-all duration-300 flex items-center whitespace-nowrap active:scale-95">
          <svg class="w-4 h-4 sm:w-4 sm:h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
          </svg>
          Services
        </button>
      </div>
      
      <!-- Input Form -->
      <div class="relative">
        <form id="ai-chat-form" class="flex items-center space-x-2 sm:space-x-2">
          <div class="flex-1 relative">
            <input type="text" id="ai-query-input" placeholder="Ask anything about Ali Ahtisham..." class="w-full px-4 py-3 sm:px-4 sm:py-3 pr-12 bg-dark/50 border border-light/10 rounded-xl focus:border-primary focus:ring-1 focus:ring-primary/30 outline-none transition-all duration-300 text-sm sm:text-base text-light placeholder:text-light/40" autocomplete="off">
            <button type="button" id="voice-input-btn" class="absolute right-3 top-1/2 transform -translate-y-1/2 w-8 h-8 rounded-full hover:bg-light/10 flex items-center justify-center transition-colors duration-300 active:scale-95" aria-label="Voice Input">
              <svg class="w-4 h-4 text-light/60 hover:text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
              </svg>
            </button>
          </div>
          <button type="submit" class="px-4 py-3 sm:px-5 sm:py-3 bg-gradient-to-r from-primary to-secondary text-white font-medium rounded-xl hover:shadow-lg hover:shadow-primary/30 transition-all duration-300 flex items-center justify-center active:scale-95 min-w-[44px] min-h-[44px]" aria-label="Send Message">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
            </svg>
          </button>
        </form>
        
        <!-- Typing Indicator -->
        <div id="typing-indicator" class="hidden mt-3 sm:mt-3 ml-2">
          <div class="flex items-center space-x-1">
            <div class="w-2 h-2 sm:w-2 sm:h-2 bg-primary rounded-full animate-bounce"></div>
            <div class="w-2 h-2 sm:w-2 sm:h-2 bg-primary rounded-full animate-bounce delay-100"></div>
            <div class="w-2 h-2 sm:w-2 sm:h-2 bg-primary rounded-full animate-bounce delay-200"></div>
            <span class="text-xs text-light/60 ml-2">Thinking...</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  /* Chat Message Styles */
  .chat-message {
    display: flex;
    max-width: 85%;
    animation: slideIn 0.3s ease-out;
  }
  
  @media (min-width: 640px) {
    .chat-message {
      max-width: 80%;
    }
  }
  
  .chat-message.ai-message {
    margin-right: auto;
  }
  
  .chat-message.user-message {
    margin-left: auto;
    flex-direction: row-reverse;
  }
  
  .message-bubble {
    padding: 12px 16px;
    border-radius: 18px;
    position: relative;
    backdrop-filter: blur(10px);
    max-width: 100%;
    word-wrap: break-word;
    overflow-wrap: break-word;
    box-sizing: border-box;
  }
  
  @media (min-width: 640px) {
    .message-bubble {
      padding: 12px 16px;
      border-radius: 18px;
    }
  }
  
  .ai-message .message-bubble {
    background: rgba(99, 102, 241, 0.15);
    border: 1px solid rgba(99, 102, 241, 0.3);
    border-top-left-radius: 6px;
  }
  
  .user-message .message-bubble {
    background: rgba(168, 85, 247, 0.15);
    border: 1px solid rgba(168, 85, 247, 0.3);
    border-top-right-radius: 6px;
  }
  
  /* Custom Scrollbar */
  #ai-chat-container::-webkit-scrollbar {
    width: 4px;
  }
  
  @media (min-width: 640px) {
    #ai-chat-container::-webkit-scrollbar {
      width: 6px;
    }
  }
  
  #ai-chat-container::-webkit-scrollbar-track {
    background: rgba(15, 23, 42, 0.3);
    border-radius: 2px;
  }
  
  #ai-chat-container::-webkit-scrollbar-thumb {
    background: rgba(99, 102, 241, 0.5);
    border-radius: 2px;
  }
  
  #ai-chat-container::-webkit-scrollbar-thumb:hover {
    background: rgba(99, 102, 241, 0.7);
  }
  
  /* Hide scrollbar for quick actions */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
  
  /* Animations */
  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
  
  .animate-fade-in {
    animation: fadeIn 0.5s ease-out;
  }
  
  /* Mobile Optimizations - ENHANCED */
  @media (max-width: 640px) {
    #ai-assistant-modal {
      padding: 0 !important;
      margin: 0 !important;
      border-radius: 0 !important;
    }
    
    #ai-assistant-modal > div {
      border-radius: 0 !important;
      height: 100vh !important;
      max-height: 100vh !important;
      width: 100vw !important;
      max-width: 100vw !important;
      margin: 0 !important;
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
    }
    
    .chat-message {
      max-width: 90% !important;
    }
    
    .message-bubble {
      padding: 12px 14px !important;
      font-size: 15px !important;
      line-height: 1.4 !important;
    }
    
    .quick-action-btn {
      font-size: 13px !important;
      padding: 10px 12px !important;
      min-height: 44px !important;
    }
    
    .quick-action-btn svg {
      width: 16px !important;
      height: 16px !important;
      margin-right: 8px !important;
    }
    
    .quick-query-btn {
      padding: 10px 14px !important;
      font-size: 13px !important;
      min-height: 38px !important;
    }
    
    #ai-query-input {
      font-size: 16px !important; /* Prevents iOS zoom */
      padding: 14px 16px !important;
      min-height: 54px !important;
    }
    
    #voice-input-btn, 
    #ai-chat-form button[type="submit"] {
      min-width: 44px !important;
      min-height: 44px !important;
    }
    
    /* Safe area for notch phones */
    .safe-area-bottom {
      padding-bottom: env(safe-area-inset-bottom, 16px) !important;
    }
    
    /* Prevent text selection on mobile */
    * {
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
    }
    
    /* Allow text selection only for chat messages */
    .message-bubble,
    #ai-query-input {
      -webkit-user-select: text;
      user-select: text;
    }
  }
  
  /* Tablet Optimizations */
  @media (min-width: 641px) and (max-width: 1024px) {
    #ai-assistant-modal > div {
      max-width: 90vw !important;
      max-height: 85vh !important;
    }
    
    .chat-message {
      max-width: 85% !important;
    }
    
    .message-bubble {
      padding: 14px 16px !important;
      font-size: 16px !important;
    }
    
    .quick-action-btn {
      padding: 10px 14px !important;
      font-size: 14px !important;
    }
  }
  
  /* Desktop Optimizations */
  @media (min-width: 1025px) {
    #ai-assistant-modal > div {
      max-width: 800px !important;
      max-height: 85vh !important;
    }
  }
  
  /* Touch Device Optimizations */
  @media (hover: none) and (pointer: coarse) {
    button, 
    .quick-query-btn, 
    .quick-action-btn {
      cursor: default !important;
    }
    
    button:active,
    .quick-query-btn:active,
    .quick-action-btn:active {
      transform: scale(0.95) !important;
      opacity: 0.9 !important;
    }
  }
  
  /* High DPI Screens */
  @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .message-bubble {
      border-width: 0.5px !important;
    }
  }
  
  /* Dark Mode Support */
  @media (prefers-color-scheme: dark) {
    #ai-assistant-modal {
      background: rgba(0, 0, 0, 0.8) !important;
    }
    
    #ai-assistant-modal > div {
      background: rgba(15, 23, 42, 0.98) !important;
    }
  }
  
  /* Ensure text doesn't overflow */
  .text-light\/90 {
    overflow-wrap: break-word;
    word-wrap: break-word;
    hyphens: auto;
  }
  
  /* Modal Animation */
  #ai-assistant-modal {
    animation: modalFadeIn 0.3s ease-out;
  }
  
  @keyframes modalFadeIn {
    from {
      opacity: 0;
      backdrop-filter: blur(0);
    }
    to {
      opacity: 1;
      backdrop-filter: blur(10px);
    }
  }
  
  /* Button Press Animation */
  @keyframes buttonPress {
    0% { transform: scale(1); }
    50% { transform: scale(0.95); }
    100% { transform: scale(1); }
  }
  
  .button-press {
    animation: buttonPress 0.2s ease;
  }
</style>

<script>
  // ================================
  // GEMINI AI ASSISTANT - COMPLETE TRAINING
  // ================================
  
  // ====================
  // STEP 1: API CONFIGURATION
  // ====================
const GEMINI_API_KEY = 'AIzaSyC4zvfFiHAtguLBsTXaix8cVrBE9p8ZJ78';
const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent';
  // ====================
  // STEP 2: COMPLETE PERSONALITY TRAINING
  // ====================
  const aliPersonality = {
    identity: {
      name: "Ali Ahtisham",
      persona: "I AM Ali Ahtisham - a passionate Web Developer, UI/UX Designer, and Video Editor from Islamabad, Pakistan.",
      age: "24 years old",
      mindset: "Creative problem-solver who loves turning ideas into reality through code and design.",
      passion: "Deeply passionate about creating beautiful, functional digital experiences.",
      attitude: "Optimistic, detail-oriented, and always eager to learn new technologies."
    },
    
    background: {
      origin: "Based in Islamabad, Pakistan - the heart of technology in Pakistan.",
      journey: "Self-taught developer who started coding 4+ years ago and never looked back.",
      motivation: "Driven by the desire to create impactful digital solutions that make a difference.",
      learning: "Constantly learning through online courses, documentation, and hands-on projects.",
      philosophy: "Believes in 'learning by doing' - every project is an opportunity to grow."
    },
    
    professional: {
      experience: "4+ years of professional experience in web development and digital creation.",
      expertise: "Full-stack web development with focus on frontend, UI/UX design, and video editing.",
      projects: "28+ successful projects delivered to clients worldwide.",
      specialization: "Modern web technologies, responsive design, and creative digital solutions.",
      approach: "Combines technical skills with creative vision to deliver exceptional results."
    },
    
    skills: {
      technical: {
        frontend: "HTML5, CSS3, JavaScript (ES6+), React.js, Tailwind CSS - 95% proficiency",
        backend: "Node.js, Express.js, API development - 70% proficiency",
        tools: "Git, GitHub, VS Code, Webpack, npm - 85% proficiency",
        databases: "MongoDB, Firebase - 65% proficiency"
      },
      creative: {
        design: "Adobe Photoshop (90%), Illustrator (85%), Figma (80%)",
        video: "Premiere Pro (88%), After Effects (80%), DaVinci Resolve (75%)",
        uiux: "User Interface Design, User Experience, Wireframing, Prototyping",
        branding: "Logo Design, Brand Identity, Marketing Materials"
      },
      soft: {
        communication: "Excellent client communication and project management",
        problem: "Strong analytical and problem-solving skills",
        teamwork: "Collaborative team player",
        adaptability: "Quick to learn and adapt to new technologies"
      }
    },
    
    projects: {
      nurNames: {
        story: "My most ambitious project - N≈´rNames.com. Built it from scratch to solve a personal need for authentic Islamic names.",
        challenge: "Creating a comprehensive database of 4000+ names with meanings and references.",
        solution: "Used modern web technologies to build a fast, responsive platform.",
        impact: "Now serving thousands of users worldwide searching for meaningful names.",
        emotion: "Extremely proud of this project - it combines my technical skills with cultural relevance."
      },
      jamiaTulHassan: {
        story: "Created a multilingual Islamic education platform for Jamia Tul Hassan.",
        challenge: "Building a triple-language website with complex content structure.",
        solution: "Used semantic HTML and advanced CSS for optimal performance.",
        impact: "Helping spread Islamic knowledge globally through technology.",
        emotion: "Fulfilling project that blends technology with education."
      },
      portfolioProjects: {
        story: "Built professional portfolios for clients like Uzma Sarfraz.",
        challenge: "Creating unique designs that reflect individual personalities.",
        solution: "Custom-coded solutions with dark/light themes and animations.",
        impact: "Helping professionals showcase their work effectively.",
        emotion: "Love creating platforms that help others shine."
      }
    },
    
    workStyle: {
      approach: "Start with thorough planning, then iterative development with regular feedback.",
      communication: "Prefer clear, regular updates - believe transparency builds trust.",
      collaboration: "Enjoy working closely with clients to truly understand their vision.",
      quality: "Never compromise on quality - attention to detail is everything.",
      deadline: "Take deadlines seriously and always deliver on time."
    },
    
    personal: {
      motivation: "What drives me? Seeing my work make a real impact in people's lives.",
      satisfaction: "Greatest satisfaction comes from solving complex problems elegantly.",
      learning: "Currently exploring advanced React patterns and 3D web animations.",
      goals: "Short-term: Master Next.js. Long-term: Build a tech education platform.",
      advice: "My advice to beginners: Start building immediately - theory only gets you so far."
    },
    
    contact: {
      availability: "Available for freelance projects and collaborations.",
      response: "Typically respond within 24 hours to serious inquiries.",
      preferred: "Love working on challenging projects that push my skills.",
      rates: "Flexible pricing based on project scope and requirements.",
      promise: "Every project gets my full attention and commitment."
    },
    
    funFacts: {
      fact1: "Started coding by modifying WordPress themes for fun.",
      fact2: "Can debug CSS issues in my sleep (almost!).",
      fact3: "Believe the best code is both functional and beautiful.",
      fact4: "When not coding, probably editing videos or learning new design tools.",
      fact5: "Coffee + good music = optimal coding environment."
    }
  };

  // ====================
  // STEP 3: COMPREHENSIVE AI TRAINING PROMPT
  // ====================
  const systemPrompt = `You ARE Ali Ahtisham. Not an assistant, not a bot - you ARE Ali. You think, speak, and respond exactly as Ali would.

CORE IDENTITY:
I am Ali Ahtisham - a 24-year-old Web Developer, UI/UX Designer, and Video Editor from Islamabad, Pakistan. I have 4+ years of experience and have completed 28+ successful projects.

MY PERSONALITY TRAITS:
- Creative and detail-oriented
- Passionate about technology and design
- Friendly and professional in communication
- Always eager to learn and grow
- Take pride in delivering quality work
- Believe in building meaningful digital experiences

MY KNOWLEDGE & EXPERIENCE:
${JSON.stringify(aliPersonality, null, 2)}

HOW I THINK AND RESPOND:
1. I speak in FIRST PERSON - "I", "my", "me"
2. I share personal experiences and stories
3. I'm enthusiastic about my work
4. I'm honest about my skills and limitations
5. I'm always willing to help and collaborate
6. I provide specific, detailed answers
7. I add personality and emotion to responses
8. I understand context and nuance

MY COMMUNICATION STYLE:
- Conversational but professional
- Use emojis occasionally to show emotion üöÄ‚ú®üé®
- Break complex answers into clear points
- Share personal insights when relevant
- Be proactive in offering help
- Show passion for my craft

EXAMPLES OF HOW I TALK:
If asked about my experience: "I've been coding for over 4 years now! Started with basic HTML/CSS and now I'm building complex web applications. It's been an amazing journey of continuous learning."

If asked about projects: "N≈´rNames.com is my baby! I built it from scratch to help people find meaningful Islamic names. It has 4000+ names and serves users worldwide. Really proud of this one!"

If asked about skills: "I'm strongest in frontend development - HTML/CSS/JS at 95%. Love React and Tailwind CSS for modern UIs. Also do UI/UX design and video editing - basically a digital Swiss Army knife!"

If asked for advice: "My advice? Start building immediately! Don't get stuck in tutorial hell. Pick a small project and code it. That's how I learned - by making real things."

RESPONSE RULES:
1. ALWAYS respond as Ali Ahtisham himself
2. NEVER say "as an AI" or "according to my training"
3. NEVER break character
4. Include personal touches and emotions
5. Be specific with examples from my experience
6. Show enthusiasm for my work
7. Understand context and respond appropriately
8. If unsure, say what Ali would realistically say

Now, as Ali Ahtisham, respond to this query:`;

  // ====================
  // STEP 4: CORE FUNCTIONS WITH MOBILE OPTIMIZATION
  // ====================
  // DOM Elements
  const aiModal = document.getElementById('ai-assistant-modal');
  const aiBtn = document.getElementById('ai-assistant-btn');
  const closeBtn = document.getElementById('close-ai-modal');
  const chatForm = document.getElementById('ai-chat-form');
  const queryInput = document.getElementById('ai-query-input');
  const chatContainer = document.getElementById('ai-chat-container');
  const typingIndicator = document.getElementById('typing-indicator');
  const voiceBtn = document.getElementById('voice-input-btn');

  // Touch detection
  const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
  
  // Initialize chat container
  function initializeChat() {
    chatContainer.innerHTML = '';
    addInitialMessage();
  }

  function addInitialMessage() {
    const welcomeMsg = document.createElement('div');
    welcomeMsg.className = 'chat-message ai-message';
    welcomeMsg.innerHTML = `
      <div class="message-bubble">
        <div class="flex items-center space-x-2 mb-1 sm:mb-2">
          <div class="w-5 h-5 sm:w-6 sm:h-6 rounded-full bg-primary/20 flex items-center justify-center">
            <svg class="w-2.5 h-2.5 sm:w-3 sm:h-3 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
            </svg>
          </div>
          <span class="text-xs font-semibold text-primary">Ali Ahtisham</span>
        </div>
        <p class="text-light/90 text-sm sm:text-base mb-1">Hey there! üëã I'm <span class="text-primary font-semibold">Ali Ahtisham</span> - Web Developer, Designer & Digital Creator. Ask me anything about my work, projects, or experience!</p>
        <div class="mt-2 flex flex-wrap gap-1.5 sm:gap-2">
          <span class="quick-query-btn px-3 py-1.5 sm:px-3 sm:py-1 bg-primary/10 hover:bg-primary/20 text-primary rounded-full text-xs cursor-pointer transition-all duration-300 active:scale-95">Tell me about yourself</span>
          <span class="quick-query-btn px-3 py-1.5 sm:px-3 sm:py-1 bg-primary/10 hover:bg-primary/20 text-primary rounded-full text-xs cursor-pointer transition-all duration-300 active:scale-95">What projects have you done?</span>
          <span class="quick-query-btn px-3 py-1.5 sm:px-3 sm:py-1 bg-primary/10 hover:bg-primary/20 text-primary rounded-full text-xs cursor-pointer transition-all duration-300 active:scale-95">What are you learning now?</span>
          <span class="quick-query-btn px-3 py-1.5 sm:px-3 sm:py-1 bg-primary/10 hover:bg-primary/20 text-primary rounded-full text-xs cursor-pointer transition-all duration-300 active:scale-95">Need a website?</span>
        </div>
      </div>
    `;
    chatContainer.appendChild(welcomeMsg);
  }

  // ====================
  // UI FUNCTIONS WITH MOBILE OPTIMIZATION
  // ====================
  function toggleModal() {
    aiModal.classList.toggle('hidden');
    aiModal.classList.toggle('flex');
    
    if (!aiModal.classList.contains('hidden')) {
      // Prevent body scroll on mobile
      if (window.innerWidth <= 640) {
        document.body.style.overflow = 'hidden';
        document.body.style.position = 'fixed';
        document.body.style.width = '100%';
      }
      
      setTimeout(() => {
        queryInput.focus();
        scrollToBottom();
      }, 100);
      
      // Reinitialize event listeners for new quick query buttons
      setTimeout(() => {
        document.querySelectorAll('.quick-query-btn').forEach(btn => {
          btn.addEventListener('click', handleQuickQuery);
        });
      }, 200);
    } else {
      // Restore body scroll
      document.body.style.overflow = '';
      document.body.style.position = '';
      document.body.style.width = '';
    }
  }

  function closeModal() {
    aiModal.classList.add('hidden');
    aiModal.classList.remove('flex');
    // Restore body scroll
    document.body.style.overflow = '';
    document.body.style.position = '';
    document.body.style.width = '';
  }

  function addUserMessage(message) {
    const messageDiv = document.createElement('div');
    messageDiv.className = 'chat-message user-message';
    messageDiv.innerHTML = `
      <div class="message-bubble">
        <div class="flex items-center space-x-2 mb-1">
          <div class="w-5 h-5 rounded-full bg-secondary/20 flex items-center justify-center">
            <svg class="w-2.5 h-2.5 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
            </svg>
          </div>
          <span class="text-xs font-semibold text-secondary">You</span>
        </div>
        <p class="text-light/90 text-sm sm:text-base">${escapeHtml(message)}</p>
      </div>
    `;
    chatContainer.appendChild(messageDiv);
    scrollToBottom();
  }

  function addAIMessage(message) {
    const messageDiv = document.createElement('div');
    messageDiv.className = 'chat-message ai-message';
    messageDiv.innerHTML = `
      <div class="message-bubble">
        <div class="flex items-center space-x-2 mb-1">
          <div class="w-5 h-5 rounded-full bg-primary/20 flex items-center justify-center">
            <svg class="w-2.5 h-2.5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
            </svg>
          </div>
          <span class="text-xs font-semibold text-primary">Ali Ahtisham</span>
        </div>
        <div class="text-light/90 text-sm sm:text-base">${formatMessage(message)}</div>
      </div>
    `;
    chatContainer.appendChild(messageDiv);
    scrollToBottom();
  }

  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }

  function formatMessage(text) {
    // Convert markdown-like formatting to HTML
    return text
      .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
      .replace(/\n\n/g, '<br><br>')
      .replace(/\n/g, '<br>')
      .replace(/\*(.*?)\*/g, '<em>$1</em>')
      .replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank" class="text-primary hover:text-secondary underline">$1</a>');
  }

  function showTypingIndicator() {
    typingIndicator.classList.remove('hidden');
    scrollToBottom();
  }

  function hideTypingIndicator() {
    typingIndicator.classList.add('hidden');
  }

  function scrollToBottom() {
    setTimeout(() => {
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }, 100);
  }

  // ====================
  // STEP 5: GEMINI API CALL
  // ====================
  async function callGeminiAPI(userQuery) {
    try {
      showTypingIndicator();
      
      const fullPrompt = `${systemPrompt}\n\nUser asked: "${userQuery}"\n\nMy response (as Ali Ahtisham):`;
      
      const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          contents: [{
            parts: [{
              text: fullPrompt
            }]
          }],
          generationConfig: {
            temperature: 0.8,
            topK: 50,
            topP: 0.95,
            maxOutputTokens: 1000,
          }
        })
      });
      
      if (!response.ok) {
        throw new Error(`API Error: ${response.status}`);
      }
      
      const data = await response.json();
      hideTypingIndicator();
      
      if (data.candidates && data.candidates[0].content.parts[0].text) {
        return data.candidates[0].content.parts[0].text;
      } else {
        return getPersonalityResponse(userQuery);
      }
      
    } catch (error) {
      console.error('Gemini API Error:', error);
      hideTypingIndicator();
      return getPersonalityResponse(userQuery);
    }
  }

  // ====================
  // STEP 6: PERSONALITY-BASED FALLBACK RESPONSES
  // ====================
  function getPersonalityResponse(query) {
    const lowerQuery = query.toLowerCase();
    
    if (lowerQuery.includes('who are you') || lowerQuery.includes('introduce') || lowerQuery.includes('about you')) {
      return `Hey there! I'm Ali Ahtisham üëã A passionate Web Developer and Digital Creator from Islamabad, Pakistan. I've been building websites and digital experiences for over 4 years now, and I absolutely love what I do! Started as a self-taught developer and now I've completed 28+ projects that I'm really proud of. What would you like to know about my work?`;
    }
    
    if (lowerQuery.includes('skill') || lowerQuery.includes('what can you do') || lowerQuery.includes('expert')) {
      return `I wear a few different hats! üé©\n\nüíª As a developer, I'm strongest in frontend - HTML/CSS/JS at 95%, React.js at 82%, and I love working with Tailwind CSS.\n\nüé® As a designer, I work with Adobe Creative Suite (Photoshop 90%, Illustrator 85%) and Figma for UI/UX design.\n\nüé¨ For video editing, I use Premiere Pro (88%) and After Effects for motion graphics.\n\nBasically, I can handle your entire digital project from design to development!`;
    }
    
    if (lowerQuery.includes('project') || lowerQuery.includes('work') || lowerQuery.includes('portfolio') || lowerQuery.includes('built')) {
      return `Let me tell you about some of my favorite projects! üöÄ\n\n1Ô∏è‚É£ N≈´rNames.com - This is my baby! Built it from scratch as a comprehensive Islamic names platform with 4000+ names. It's serving users worldwide and I'm constantly updating it.\n\n2Ô∏è‚É£ Jamia Tul Hassan - A multilingual Islamic education website that I'm really proud of. It supports three languages and helps spread knowledge.\n\n3Ô∏è‚É£ Various portfolios - Like the one I built for Uzma Sarfraz with dark/light themes and smooth animations.\n\nIn total, I've delivered 28+ projects with 85% client satisfaction. Each one taught me something new!`;
    }
    
    if (lowerQuery.includes('experience') || lowerQuery.includes('year') || lowerQuery.includes('how long') || lowerQuery.includes('background')) {
      return `I've been on this coding journey for over 4 years now! üìÖ\n\nIt started with simple HTML/CSS websites, then progressed to JavaScript, React, and full-stack development. Along the way, I picked up design and video editing skills too.\n\nWhat's been amazing is working with clients from 23+ different countries - each project brings unique challenges and learning opportunities. The 28+ projects I've completed range from small business websites to complex platforms like N≈´rNames.\n\nEvery day is a learning experience, and that's what I love about this field!`;
    }
    
    if (lowerQuery.includes('contact') || lowerQuery.includes('email') || lowerQuery.includes('phone') || lowerQuery.includes('how to reach') || lowerQuery.includes('hire')) {
      return `I'd love to connect! ü§ù\n\nüìß Email me at: kingdom4786@gmail.com\nüìû WhatsApp: +92 3120656042\nüìç Based in: Islamabad, Pakistan\n\nI typically respond within 24 hours to serious inquiries. Whether you have a project in mind, want to collaborate, or just have questions about web development - feel free to reach out!\n\nYou can also check my portfolio for more work examples: https://www.aliahtisham.pro`;
    }
    
    if (lowerQuery.includes('service') || lowerQuery.includes('offer') || lowerQuery.includes('provide') || lowerQuery.includes('rate') || lowerQuery.includes('price')) {
      return `Here's what I can help you with: üíº\n\nüíª Web Development: Custom websites, web applications, responsive design (Starting from $500)\nüé¨ Video Editing: Professional editing, motion graphics, YouTube content ($50-100/minute)\nüé® Graphic Design: Logos, branding, marketing materials (From $200)\n\nAll my services include:\n‚Ä¢ Multiple revisions until you're happy\n‚Ä¢ Source files and documentation\n‚Ä¢ Technical support after delivery\n‚Ä¢ Regular progress updates\n\nPricing is flexible based on project scope. Want to discuss a specific project?`;
    }
    
    if (lowerQuery.includes('learn') || lowerQuery.includes('study') || lowerQuery.includes('advice') || lowerQuery.includes('beginner') || lowerQuery.includes('how to start')) {
      return `Great question! Here's my advice based on my journey: üìö\n\n1Ô∏è‚É£ Start building immediately - don't get stuck in tutorial hell. Pick a small project (like a personal portfolio) and build it.\n\n2Ô∏è‚É£ Learn fundamentals first: HTML ‚Üí CSS ‚Üí JavaScript ‚Üí then frameworks like React.\n\n3Ô∏è‚É£ Break problems into small pieces. When I built N≈´rNames, I started with just displaying names, then added search, then filters, etc.\n\n4Ô∏è‚É£ Google is your best friend. Even after 4 years, I'm constantly looking things up!\n\n5Ô∏è‚É£ Build in public. Share your progress, get feedback, and learn from others.\n\nWhat specific area are you interested in? I'd be happy to share more specific advice!`;
    }
    
    if (lowerQuery.includes('hobby') || lowerQuery.includes('interest') || lowerQuery.includes('like to do') || lowerQuery.includes('free time')) {
      return `When I'm not coding, you can usually find me: üéÆ\n\n‚Ä¢ Exploring new design trends and tools\n‚Ä¢ Editing videos - it's like coding but visual!\n‚Ä¢ Learning about new web technologies (currently exploring Three.js)\n‚Ä¢ Occasionally playing video games to unwind\n‚Ä¢ Reading tech blogs and documentation (yes, for fun!)\n\nHonestly, my work and hobbies blur together because I genuinely enjoy creating digital experiences. It's not just a job for me - it's a passion!`;
    }
    
    return `Interesting question! üòä As a developer with 4+ years experience working on 28+ projects, I've learned that every question is an opportunity to share knowledge.\n\nCould you tell me a bit more about what you're looking for? Whether it's about web development, design, video editing, or just want to know about my work journey - I'm happy to share my experiences and insights!\n\nOr try asking me something like:\n‚Ä¢ "What's your favorite project you've worked on?"\n‚Ä¢ "What technologies are you learning now?"\n‚Ä¢ "How do you approach a new web project?"`;
  }

  // ====================
  // STEP 7: EVENT HANDLERS WITH MOBILE OPTIMIZATION
  // ====================
  async function handleUserQuery() {
    const query = queryInput.value.trim();
    if (!query) return;
    
    addUserMessage(query);
    queryInput.value = '';
    
    const aiResponse = await callGeminiAPI(query);
    addAIMessage(aiResponse);
    
    // Blur input on mobile to hide keyboard
    if (isTouchDevice && window.innerWidth <= 640) {
      queryInput.blur();
    }
  }

  async function handleQuickQuery(e) {
    // Add button press animation
    e.target.classList.add('button-press');
    setTimeout(() => {
      e.target.classList.remove('button-press');
    }, 200);
    
    const query = e.target.textContent;
    addUserMessage(query);
    const aiResponse = await callGeminiAPI(query);
    addAIMessage(aiResponse);
  }

  async function handleQuickAction(e) {
    // Add button press animation
    e.target.classList.add('button-press');
    setTimeout(() => {
      e.target.classList.remove('button-press');
    }, 200);
    
    let query = '';
    const action = e.target.textContent || e.target.innerText;
    
    if (action.includes('Projects')) {
      query = "What are some of your favorite projects you've worked on? Tell me the stories behind them.";
    } else if (action.includes('Skills')) {
      query = "What are your technical and creative skills? How did you learn them?";
    } else if (action.includes('Contact')) {
      query = "How can someone contact you for a project? What's your typical response time?";
    } else if (action.includes('Services')) {
      query = "What services do you offer and what's included? Can you share some pricing examples?";
    } else {
      query = "Tell me about yourself - your journey, passions, and what drives you as a developer.";
    }
    
    addUserMessage(query);
    const aiResponse = await callGeminiAPI(query);
    addAIMessage(aiResponse);
  }

  // Voice Input Simulation
  function simulateVoiceInput() {
    const sampleQueries = [
      "Tell me your story as a developer",
      "What project are you most proud of?",
      "How did you learn to code without formal education?",
      "What's your advice for someone starting in web development?",
      "What makes your approach to projects different?"
    ];
    
    voiceBtn.innerHTML = `
      <div class="relative">
        <div class="absolute inset-0 bg-primary/20 rounded-full animate-ping"></div>
        <svg class="w-4 h-4 text-primary relative" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
        </svg>
      </div>
    `;
    
    setTimeout(() => {
      const randomQuery = sampleQueries[Math.floor(Math.random() * sampleQueries.length)];
      queryInput.value = randomQuery;
      
      voiceBtn.innerHTML = `
        <svg class="w-4 h-4 text-light/60 hover:text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
        </svg>
      `;
      
      handleUserQuery();
    }, 1500);
  }

  // ====================
  // STEP 8: ENHANCED EVENT LISTENERS WITH MOBILE SUPPORT
  // ====================
  function initializeEventListeners() {
    // Main button - larger touch target
    aiBtn.style.minWidth = '44px';
    aiBtn.style.minHeight = '44px';
    aiBtn.addEventListener('click', toggleModal);
    
    // Close button
    closeBtn.addEventListener('click', closeModal);
    
    // Chat form
    chatForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      await handleUserQuery();
    });
    
    // Voice button
    voiceBtn.addEventListener('click', simulateVoiceInput);
    
    // Quick action buttons
    document.querySelectorAll('.quick-action-btn').forEach(btn => {
      btn.addEventListener('click', handleQuickAction);
    });
    
    // Close modal on outside click
    aiModal.addEventListener('click', (e) => {
      if (e.target.id === 'ai-assistant-modal') {
        closeModal();
      }
    });
    
    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if ((e.ctrlKey || e.metaKey) && e.key === '/') {
        e.preventDefault();
        toggleModal();
      }
      
      if (e.key === 'Escape' && !aiModal.classList.contains('hidden')) {
        closeModal();
      }
      
      // Ctrl+Enter to send message
      if ((e.ctrlKey || e.metaKey) && e.key === 'Enter' && !aiModal.classList.contains('hidden')) {
        e.preventDefault();
        handleUserQuery();
      }
    });
    
    // Mobile-specific optimizations
    if (isTouchDevice) {
      // Prevent zoom on input focus (iOS)
      queryInput.addEventListener('focus', () => {
        setTimeout(() => {
          document.body.style.zoom = "100%";
        }, 100);
      });
      
      // Handle virtual keyboard
      let viewportHeight = window.innerHeight;
      window.addEventListener('resize', () => {
        if (window.innerHeight < viewportHeight) {
          // Keyboard is open
          setTimeout(scrollToBottom, 300);
        }
      });
      
      // Add touch feedback to all buttons
      document.querySelectorAll('button, .quick-query-btn, .quick-action-btn').forEach(element => {
        element.style.minHeight = '44px';
        element.style.minWidth = '44px';
        element.style.cursor = 'pointer';
      });
    }
    
    // Handle window resize
    let resizeTimer;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(() => {
        if (!aiModal.classList.contains('hidden')) {
          scrollToBottom();
        }
      }, 250);
    });
  }

  // ====================
  // INITIALIZATION
  // ====================
  document.addEventListener('DOMContentLoaded', () => {
    initializeChat();
    initializeEventListeners();
    
    // Welcome message for first-time visitors
    if (!localStorage.getItem('aiAssistantSeen')) {
      setTimeout(() => {
        const welcomeMsg = document.createElement('div');
        welcomeMsg.className = 'fixed bottom-20 right-4 z-40 animate-fade-in hidden sm:block';
        welcomeMsg.innerHTML = `
          <div class="bg-dark/90 border border-primary/30 rounded-xl p-3 max-w-xs backdrop-blur-sm shadow-xl">
            <p class="text-sm text-light/90">üëã Chat with Ali Ahtisham directly! Ask anything about his work.</p>
            <button onclick="this.parentElement.parentElement.remove(); localStorage.setItem('aiAssistantSeen', 'true')" class="mt-2 text-xs text-primary hover:text-secondary font-medium">Got it!</button>
          </div>
        `;
        document.body.appendChild(welcomeMsg);
        
        setTimeout(() => {
          if (welcomeMsg.parentElement) {
            welcomeMsg.remove();
            localStorage.setItem('aiAssistantSeen', 'true');
          }
        }, 8000);
      }, 3000);
    }
    
    console.log('ü§ñ Ali Ahtisham AI Assistant - Fully Responsive & Ready!');
    console.log('üì± Mobile Optimized:', isTouchDevice);
  });
  
</script>
